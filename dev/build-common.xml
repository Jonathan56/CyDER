<?xml version="1.0" encoding="ISO-8859-1"?>
<project name="fmu-settings"> 
 <property name="VERSION"  value="0.1.0"/>

  <!-- Version information -->
  <filterset id="build.filters">
    <filter token="VERSION" value="${VERSION}"/>
    <filter token="DATE" value="${TODAY}"/>
    <filter token="TIME" value="${TSTAMP}"/>
  </filterset>

  <!-- Set file separator that are used by different build files -->
  <condition property="file.separator" value="/">
    <os name="Mac OS X"/>
  </condition>
  <condition property="file.separator" value="/">
    <os name="Linux"/>
  </condition>
  <condition property="file.separator" value="\">
    <os family="windows"/>
  </condition>

  <!-- Get environment variables and user properties -->
  <property environment="env"/>
  <property file="${env.FMU_HOME}${file.separator}user.properties"/>
  <property file="${env.FMU_HOME}${file.separator}build.properties"/>
  <!-- 
       Set properties that depend on tools that a user has installed.
       Note that conditions need to be set. Reading just the property
       file is not sufficent for a conditional execution of the targets
   -->  

  <!-- Define path to the fmus-->
  <condition property="path.fmus" 
  value="${env.FMU_HOME}${file.separator}fmus${file.separator}linux64${file.separator}">
    <os name="Linux"/>
  </condition>
  <condition property="path.fmus" 
  value="${env.FMU_HOME}${file.separator}fmus${file.separator}win64${file.separator}">
    <os family="windows"/>
 </condition>

  <!-- Define path to FMU checker-->
  <property name="path.fmuChecker"  value="${env.FMU_HOME}${file.separator}fmuChecker${file.separator}"/>

  <!-- Define fmuCheck executable-->
  <condition property="checker" value="fmuCheck.linux64">
    <os name="Linux"/>
  </condition>
  <condition property="checker" value="fmuCheck.win64">
    <os family="windows"/>
  </condition>

  <!-- Set conditions that are used by different build files -->
  <condition property="mac" value="true">
    <os name="Mac OS X"/>
  </condition>
  <condition property="linux" value="true">
    <os name="Linux"/>
  </condition>
  <condition property="windows" value="true">
    <os family="windows"/>
  </condition>

  <property name="compiler.debug" value="false"/>
  
  <tstamp>
    <format property="year" pattern="yyyy"/>
  </tstamp>

  <!-- Set c compiler and object file extension -->
  <condition property="cc" value="msvc">
    <os family="windows"/>
  </condition>
  <condition property="cc" value="gcc">
    <os family="unix"/>
  </condition>
  <condition property="extObj" value="obj">
    <os family="windows"/>
  </condition>
  <condition property="extObj" value="o">
    <os family="unix"/>
  </condition>

  <!-- Check if built system is configured -->
  <target name="checkConfig" description="Checks if the built system is configured.">
  <fail unless="classPathLBNLActorsSet"
	message="CLASSPATH does not seem to be set to lib directory of the FMU. 
	Did you run 'source bin/setDevelopmentEnvironment.sh' on Linux or Mac 
	or 'bin/setDevelopmentEnvironment.bat' on Windows?"/>
  </target>

  <!-- Diagnostics information -->
  <target name="diagnostics" description="Outputs diagnostics information">
    <echo message="os.name = ${os.name}"/>
    <echo message="os.arch = ${os.arch}"/>
    <echo message="Compiler = ${cc}"/>
    <echo message="FMU_HOME = ${env.FMU_HOME}"/>
    <echoproperties>
      <propertyset>
        <propertyref prefix="env.FMU"/>
        <propertyref prefix="have."/>
        <propertyref prefix="path."/>
      </propertyset>
    </echoproperties>
    <echo message="cc.compile      = ${cc.compile}"/>
    <echo message="cc.link         = ${cc.link}"/>
    <echo message="ifort.compile   = ${ifort.compile}"/>
    <echo message="ifort.link      = ${ifort.link}"/>
    <echo message="java.class.path = ${java.class.path}"/>
   </target>

</project>
